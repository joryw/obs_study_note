- [npm、yarn、pnpm区别是什么，  新项目推荐使用哪个](#npm%E3%80%81yarn%E3%80%81pnpm%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%20%20%E6%96%B0%E9%A1%B9%E7%9B%AE%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8%E5%93%AA%E4%B8%AA)
	- [核心区别一览](#%E6%A0%B8%E5%BF%83%E5%8C%BA%E5%88%AB%E4%B8%80%E8%A7%88)
	- [各自特点简述](#%E5%90%84%E8%87%AA%E7%89%B9%E7%82%B9%E7%AE%80%E8%BF%B0)
	- [新项目推荐](#%E6%96%B0%E9%A1%B9%E7%9B%AE%E6%8E%A8%E8%8D%90)
	- [实际落地建议](#%E5%AE%9E%E9%99%85%E8%90%BD%E5%9C%B0%E5%BB%BA%E8%AE%AE)
- [corepack又是什么](#corepack%E5%8F%88%E6%98%AF%E4%BB%80%E4%B9%88)
	- [Corepack 是做什么的](#Corepack%20%E6%98%AF%E5%81%9A%E4%BB%80%E4%B9%88%E7%9A%84)
	- [和直接装 pnpm 有什么区别](#%E5%92%8C%E7%9B%B4%E6%8E%A5%E8%A3%85%20pnpm%20%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB)
	- [怎么简单用 Corepack + pnpm](#%E6%80%8E%E4%B9%88%E7%AE%80%E5%8D%95%E7%94%A8%20Corepack%20+%20pnpm)

# npm、yarn、pnpm区别是什么，  新项目推荐使用哪个
npm、Yarn、pnpm 都是 Node.js 的包管理器，核心功能一样：装包、锁版本、管理依赖，但实现方式和侧重点不同。[1]

## 核心区别一览

| 维度           | npm                           | Yarn (v1/v3+)                          | pnpm                                   |
|----------------|-------------------------------|----------------------------------------|----------------------------------------|
| 安装速度       | 最慢，[pnpm、Yarn 明显更快][2] | 快，支持并行安装和缓存[2]             | 通常最快，官方基准中安装时间最短[3][4] |
| 磁盘占用       | 最大，重复安装依赖[2][5]   | 略好于 npm，[Plug’n’Play 可去 node_modules][6] | 最省磁盘，单一全局内容寻址仓库存包[7][3] |
| 依赖结构       | 扁平 node_modules，容易“幽灵依赖”[8] | 类似 npm，但有更好的锁定机制[2]         | 严格依赖隔离，避免未声明依赖可被访问[9][8] |
| Monorepo 支持 | 有 workspace，但较弱[2][10] | 有 workspaces，配合 Berry 较强[2][10] | 一流的 workspace/monorepo 体验[10][2] |
| 生态与默认     | Node 自带、生态最大[1][5] | 用的人多，但增速放缓[1]                | 近两年在团队、企业和 monorepo 中迅速流行[2][11] |
| 适用场景       | 小项目、老项目、初学者[10][11] | 已经在用 Yarn 的项目[10]               | 新项目、Monorepo、追求速度/磁盘效率[10][11][7] |

## 各自特点简述

- **npm**  
  - Node 附带，无需额外安装，命令最“标准”，适合简单或已有 npm 的项目。[1][5]
  - 相比另外两个，在大项目上会慢、占空间更大，依赖树扁平导致依赖“隐式可见”，安全性略差。[2][8]

- **Yarn**  
  - 通过并行安装和缓存提升速度，引入 yarn.lock 保证安装可重复。[2][5]
  - Yarn Berry 提供 Plug’n’Play（无 node_modules），CI 非常快，但上手和调试成本略高。[6][12]

- **pnpm**  
  - 使用“内容寻址存储”：全局只存一份包文件，然后通过硬链接/符号链接到各项目，既快又省磁盘。[7][3]
  - 依赖严格隔离，只有 package.json 里声明的依赖才能访问，安全性和可维护性更好，Monorepo/workspaces 体验突出。[9][2][10]

## 新项目推荐

综合 2024–2026 的社区趋势和基准测试，默认推荐：**pnpm 优先，其次 npm，Yarn 更多是存量项目继续用**。[11][7][12]

- 如果是普通新项目（比如 Next.js、Vite、Nest 等）  
  - 推荐直接用 **pnpm**：安装快、占盘小、对 CI 和 Docker 都友好，几乎所有主流脚手架都已支持。[7][3][13]
  - 初期上手成本很低，命令和 npm 基本一一对应（npm install → pnpm install）。[8]

- 如果是大型 Monorepo 或团队协作项目  
  - 强烈推荐 **pnpm**，内置 workspace/monorepo 能力被很多公司当成“专业标准”。[10][2][13]

- 只有在这些情况下可以考虑不用 pnpm：  
  - 公司规范强制 npm 或 Yarn；  
  - 需要 Yarn Berry 的某些特性（如极致的 zero‑install / PnP）；[6][14]
  - 维护老项目，已经深度绑定 npm/Yarn，不想迁移。[10][15]

## 实际落地建议

- 新项目初始化时：  
  - 安装 pnpm：`npm i -g pnpm`。[8]
  - 脚手架：大部分 CLI 支持 `--package-manager=pnpm` 或自动检测。[14]

- 团队协作注意事项：  
  - 在 README 写明统一使用 pnpm，并提交 `pnpm-lock.yaml`；[2]
  - CI 中把 `npm ci` 改为 `pnpm install --frozen-lockfile`，保证锁文件一致。[14]

Sources
[1] Package Managers Comparison: Yarn, NPM, PNPM https://www.cookielab.io/blog/package-managers-comparison-yarn-npm-pnpm
[2] Understanding Package Managers: pnpm vs npm vs yarn https://dev.to/jenueldev/understanding-package-managers-pnpm-vs-npm-vs-yarn-jnp
[3] Benchmarks of JavaScript Package Managers - PNPM https://pnpm.io/benchmarks
[4] PNPM vs NPM: Why You Should Switch in 2025 - The Glitched Goblet https://glitchedgoblet.blog/post/pnpm
[5] Choosing the Right Package Manager: npm vs yarn vs pnpm vs bun https://www.deployhq.com/blog/choosing-the-right-package-manager-npm-vs-yarn-vs-pnpm-vs-bun
[6] PNPM Vs. NPM Vs. Yarn: Which Package Manager is Right ... https://www.dhiwise.com/post/pnpm-vs-npm-vs-yarn-which-javascript-package-manager
[7] PNPM vs NPM: Why You Should Switch in 2025 https://dev.to/thelogicwarlock/pnpm-vs-npm-why-you-should-switch-in-2025-4egg
[8] pnpm vs npm https://pnpm.io/pnpm-vs-npm
[9] Why you should prefer using pnpm over npm and yarn? https://refine.dev/blog/pnpm-vs-npm-and-yarn/
[10] Advantages Of Pnpm https://www.syncfusion.com/blogs/post/pnpm-vs-npm-vs-yarn
[11] npm vs Yarn vs pnpm – Which Package Manager Should You Use ... https://dev.to/hamzakhan/npm-vs-yarn-vs-pnpm-which-package-manager-should-you-use-in-2025-2f1g
[12] Choosing the Right JavaScript Package Manager in 2025: npm vs ... https://developersvoice.com/blog/js/npm-yarn-pnpm-bun-comparison/
[13] In 2025, is there still a clear winner between npm, pnpm, and bun? https://github.com/orgs/community/discussions/182181
[14] PNPM vs. Bun Install vs. Yarn Berry https://betterstack.com/community/guides/scaling-nodejs/pnpm-vs-bun-install-vs-yarn/
[15] npm vs yarn vs pnpm: A Comprehensive Guide to Choosing the Right Package Manager https://dev.to/raajaryan/npm-vs-yarn-vs-pnpm-a-comprehensive-guide-to-choosing-the-right-package-manager-1o1g
[16] [AskJS] Pnpm and Npm difference https://www.reddit.com/r/javascript/comments/1l9jm5k/askjs_pnpm_and_npm_difference/
[17] pnpm vs yarn v4 https://www.reddit.com/r/typescript/comments/1ainj58/pnpm_vs_yarn_v4/
[18] Package Manager choice (npm vs yarn vs pnpm) https://forum.xwiki.org/t/package-manager-choice-npm-vs-yarn-vs-pnpm/13420
[19] Pnpm vs Npm vs Yarn - What to Choose? https://www.youtube.com/watch?v=kVJ0yoXCORE
[20] what is the difference between npm and pnpm and yarn https://www.reddit.com/r/node/comments/10n8t9l/what_is_the_difference_between_npm_and_pnpm_and/


# corepack又是什么
Corepack 是 Node.js 自带的一个“包管理器管理器”，专门用来管理 npm / Yarn / pnpm 这些包管理器的版本，并帮你自动安装、切换和锁定它们。 [2][4]

## Corepack 是做什么的

- 它在 Node.js 里内置了一层“代理”，当你运行 `pnpm`、`yarn` 这类命令时，会根据项目配置自动下载对应版本，并帮你执行。这样你不需要手动全局安装指定版本的 pnpm / Yarn。 [2][7]
- 它可以根据项目里的配置文件（比如 `package.json` 里的 `packageManager` 字段）保证整个团队都使用同一个包管理器版本，减少“我这里可以跑、你那里不行”的问题。 [2][3]

## 和直接装 pnpm 有什么区别

- 不用 Corepack：你会手动 `npm i -g pnpm`、`npm i -g yarn`，每台电脑自己维护一套版本，版本不一致容易出问题。 [3][4]
- 用 Corepack：  
  - Node 自带一个 corepack 命令；  
  - 项目里写明要用 `pnpm@x.y.z`；  
  - 新人只要 `corepack enable`，再进项目目录直接用 `pnpm`，Corepack 会自动拉下正确版本。 [3][5]

## 怎么简单用 Corepack + pnpm

常见 Node 版本（16.9+）一般已经带 Corepack： [2][7]

```bash
# 启用 corepack（推荐只跑一次）
corepack enable

# 安装并激活最新版 pnpm
corepack prepare pnpm@latest --activate

# 之后就可以直接用 pnpm
pnpm --version
```

这样你不需要 `npm install -g pnpm`，也能在不同项目中用到指定版本的 pnpm。 [2][3]

> 补充信息：目前 Corepack 还是“实验特性”，Node 社区已决定未来高版本会逐步移除内置 Corepack，老版本 Node 里仍可正常使用，所以现在用没问题，但长期可以预留一个“直接全局安装 pnpm”的备用方案。 [6]

Sources
[1] Corepack - experimental new Node.js feature to automatically manage package managers https://www.reddit.com/r/javascript/comments/pjkdms/corepack_experimental_new_nodejs_feature_to/
[2] Corepack 核心包| Node.js v18 文档 https://nodejs.cn/api/v18/corepack.html
[3] Corepack - 樱桃茶 https://doc.cherrychat.org/node/node%E6%96%87%E6%A1%A3/Corepack.html
[4] Corepack 核心包| Node.js API 文档 https://nodejs.cn/api-v14/corepack.html
[5] Corepack 是什麼？完整解析與常見問題解決方案 https://realnewbie.com/coding/javascript/what-is-corepack-complete-analysis-and-common-solutions/
[6] Node.js TSC最新决定：逐步移除Corepack 转载 - CSDN博客 https://blog.csdn.net/xgangzai/article/details/146719414
[7] Corepack | Node.js v21.7.2 文档 https://node.org.cn/api/corepack.html
[8] Corepack - experimental new Node.js feature to automatically manage package managers https://www.reddit.com/r/javascript/comments/pjkdms/corepack_experimental_new_nodejs_feature_to/?tl=zh-hans
[9] corepack使用指南 https://juejin.cn/post/7526192976920330286
[10] 锁定Node.js的包管理：Corepack使用指南 - 稀土掘金 https://juejin.cn/post/7352739150242496527
